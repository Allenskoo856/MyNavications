# 监控与运维

## 监控指标

- 应用：CPU、内存、线程数、JVM 堆内存使用、GC 频率
- 接口：响应时间（平均/95/99 分位）、请求量（QPS）、错误率
- 数据库：连接数、慢查询、锁等待、TPS
- 缓存：命中率、Keys 数量、内存使用

## 推荐工具

- Prometheus + Grafana：指标采集与可视化
- ELK/EFK（Elasticsearch + Filebeat + Kibana）：日志采集与查询
- Alertmanager：告警管理
- Jaeger：分布式链路追踪

## 日志管理

- 将应用日志输出至标准输出（容器化场景）或文件（系统级部署）
- 使用 Filebeat 或 Fluentd 收集日志并发送到 Elasticsearch
- 日志结构化输出，便于搜索和聚合

## 健康检查

- 提供健康检查接口（`/actuator/health` 或自定义）
- 在容器编排平台（Docker Swarm、K8s）中配置就绪探针与存活探针

## 告警策略

- CPU/内存超过阈值（例如 80%）
- 接口 5xx 错误率超过阈值
- 数据库连接接近上限

## 性能基线与容量规划

- 建立基线：在预发布环境进行压力测试，记录响应时间和资源消耗
- 容量规划：根据峰值 QPS、平均响应时间和SLA 计算需要的实例数

## 日常运维流程

- 日志分析：定期检查错误与异常日志
- 安全更新：及时更新依赖并扫描漏洞
- 数据备份：定期备份数据库与配置文件
- 灾备演练：定期进行恢复演练

---

*最后更新: 2025年9月9日*
